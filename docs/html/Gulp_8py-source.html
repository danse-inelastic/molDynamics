<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>molDynamics: molDynamics/gulp/Gulp.py Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.1 -->
<div class="tabs">
  <ul>
    <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="namespaces.html"><span>Packages</span></a></li>
    <li><a href="classes.html"><span>Classes</span></a></li>
    <li id="current"><a href="files.html"><span>Files</span></a></li>
    <li><a href="dirs.html"><span>Directories</span></a></li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
  </ul></div>
<div class="nav">
<a class="el" href="dir_0fe97e93304435d2463c2ea1c1e66b1b.html">molDynamics</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_d26e7f3dd8b2b218871de9d1e37c61cd.html">gulp</a></div>
<h1>Gulp.py</h1><a href="Gulp_8py.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a><a class="code" href="namespacemolDynamics_1_1gulp_1_1Gulp.html">00001</a> <span class="comment">#!/usr/bin/env python</span>
<a name="l00002"></a>00002 <span class="comment">#</span>
<a name="l00003"></a>00003 <span class="comment"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
<a name="l00004"></a>00004 <span class="comment">#</span>
<a name="l00005"></a>00005 <span class="comment">#                                Brandon Keith</span>
<a name="l00006"></a>00006 <span class="comment">#                      California Institute of Technology</span>
<a name="l00007"></a>00007 <span class="comment">#              (C) 2005 All Rights Reserved  All Rights Reserved</span>
<a name="l00008"></a>00008 <span class="comment">#</span>
<a name="l00009"></a>00009 <span class="comment"># {LicenseText}</span>
<a name="l00010"></a>00010 <span class="comment">#</span>
<a name="l00011"></a>00011 <span class="comment"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
<a name="l00012"></a>00012 <span class="comment">#</span>
<a name="l00013"></a>00013 <span class="keyword">from</span> molDynamics.MolDynamics <span class="keyword">import</span> MolDynamics
<a name="l00014"></a>00014 <span class="keyword">from</span> molDynamics.gulp.Coordinates <span class="keyword">import</span> Coordinates
<a name="l00015"></a>00015 <span class="keyword">from</span> os <span class="keyword">import</span> system, linesep
<a name="l00016"></a>00016 <span class="keyword">from</span> molDynamics.gulp.forcefields.UreaForcefield <span class="keyword">import</span> UreaForcefield
<a name="l00017"></a>00017   
<a name="l00018"></a><a class="code" href="classmolDynamics_1_1gulp_1_1Gulp_1_1Gulp.html">00018</a> <span class="keyword">class </span><a class="code" href="classmolDynamics_1_1gulp_1_1Gulp_1_1Gulp.html">Gulp</a>(<a class="code" href="classmolDynamics_1_1MolDynamics_1_1MolDynamics.html">MolDynamics</a>):
<a name="l00019"></a>00019     <span class="stringliteral">"""GULP MD engine for MolDynamics interface.  </span>
<a name="l00020"></a><a class="code" href="classmolDynamics_1_1gulp_1_1Gulp_1_1Gulp_1_1Inventory.html">00020</a> <span class="stringliteral">    </span>
<a name="l00021"></a>00021 <span class="stringliteral">This class maps the DANSE data structures to GULP's input deck."""</span>
<a name="l00022"></a><a class="code" href="classmolDynamics_1_1gulp_1_1Gulp_1_1Gulp_1_1Inventory.html#e009edf4938f49778de0a774038427fc">00022</a>     <span class="keyword">class </span><a class="code" href="classmolDynamics_1_1gulp_1_1Gulp_1_1Gulp_1_1Inventory.html">Inventory</a>(<a class="code" href="classmolDynamics_1_1MolDynamics_1_1MolDynamics.html">MolDynamics</a>.Inventory):
<a name="l00023"></a>00023         <span class="keyword">import</span> pyre.inventory <span class="keyword">as</span> inv
<a name="l00024"></a><a class="code" href="classmolDynamics_1_1gulp_1_1Gulp_1_1Gulp_1_1Inventory.html#56dca8eea0994d9cab9a9ffae085d374">00024</a>         computeMaterialProperties = inv.bool(<span class="stringliteral">'Compute Material Properties'</span>, default = <span class="keyword">False</span>)
<a name="l00025"></a>00025         computeMaterialProperties.meta[<span class="stringliteral">'tip'</span>] = <span class="stringliteral">'whether to print material properties'</span>
<a name="l00026"></a>00026         constantPressureFit = inv.bool(<span class="stringliteral">'Constant Pressure Fit'</span>, default = <span class="keyword">False</span>)
<a name="l00027"></a><a class="code" href="classmolDynamics_1_1gulp_1_1Gulp_1_1Gulp_1_1Inventory.html#4c08bc224bf05c05a76ee61cc454ec48">00027</a>         constantPressureFit.meta[<span class="stringliteral">'tip'</span>] = <span class="stringliteral">'''keep pressure constant during fitting (fit </span>
<a name="l00028"></a>00028 <span class="stringliteral">to irreducible cell coordinates and lattice lengths)'''</span>
<a name="l00029"></a><a class="code" href="classmolDynamics_1_1gulp_1_1Gulp_1_1Gulp_1_1Inventory.html#638dabb7934d40d897bb5f52d8d2ff58">00029</a>         constantPressureOptimize = inv.bool(<span class="stringliteral">'Constant Pressure Optimize'</span>, default = <span class="keyword">False</span>)
<a name="l00030"></a>00030         constantPressureOptimize.meta[<span class="stringliteral">'tip'</span>] = <span class="stringliteral">'''keep pressure constant during optimization'''</span>
<a name="l00031"></a>00031         constantVolumeFit = inv.bool(<span class="stringliteral">'Constant Volume Fit'</span>, default = <span class="keyword">False</span>)
<a name="l00032"></a><a class="code" href="classmolDynamics_1_1gulp_1_1Gulp_1_1Gulp_1_1Inventory.html#dba90fc0610a2841aa8b089d6ad0933e">00032</a>         constantVolumeFit.meta[<span class="stringliteral">'tip'</span>] = <span class="stringliteral">'''keep volume constant during fitting (fit </span>
<a name="l00033"></a>00033 <span class="stringliteral">to irreducible cell coordinates)'''</span>
<a name="l00034"></a><a class="code" href="classmolDynamics_1_1gulp_1_1Gulp_1_1Gulp_1_1Inventory.html#8d536fc9c52264856b2680cee97afa5f">00034</a>         constantVolumeOptimize = inv.bool(<span class="stringliteral">'Constant Volume Optimize'</span>, default = <span class="keyword">False</span>)
<a name="l00035"></a>00035         constantVolumeOptimize.meta[<span class="stringliteral">'tip'</span>] = <span class="stringliteral">'''keep volume constant during optimization'''</span>
<a name="l00036"></a>00036         dispersionInRecipSpace = inv.bool(<span class="stringliteral">'Calculate Dispersion in Reciprocal Space'</span>, default = <span class="keyword">False</span>)
<a name="l00037"></a><a class="code" href="classmolDynamics_1_1gulp_1_1Gulp_1_1Gulp_1_1Inventory.html#0c03adabd20714dbd5ea619ea4c0291d">00037</a>         dispersionInRecipSpace.meta[<span class="stringliteral">'tip'</span>] = <span class="stringliteral">'''whether to calculate dispersion forces </span>
<a name="l00038"></a>00038 <span class="stringliteral">partly in reciprocal space'''</span>
<a name="l00039"></a>00039         forcefields = inv.facility(<span class="stringliteral">'forcefields'</span>, default=UreaForcefield())<span class="comment">#'Urea')</span>
<a name="l00040"></a><a class="code" href="classmolDynamics_1_1gulp_1_1Gulp_1_1Gulp_1_1Inventory.html#5ffea37571e4b350a4b4cc3d1eae869d">00040</a>         forcefields.meta[<span class="stringliteral">'tip'</span>] = <span class="stringliteral">'a class containing forcefield types'</span>
<a name="l00041"></a>00041 <span class="comment">#        forcefields.meta['known_plugins'] = ['Urea','Alumina']</span>
<a name="l00042"></a>00042         identifyMolecules = inv.bool(<span class="stringliteral">'Indentify Molecules'</span>, default = <span class="keyword">False</span>)
<a name="l00043"></a><a class="code" href="classmolDynamics_1_1gulp_1_1Gulp_1_1Gulp_1_1Inventory.html#68f66296c88613874928ca4487254fc0">00043</a>         identifyMolecules.meta[<span class="stringliteral">'tip'</span>] = <span class="stringliteral">'''identify molecules based on covalent radii </span>
<a name="l00044"></a>00044 <span class="stringliteral">and remove intramolecular coloumb interactions'''</span>
<a name="l00045"></a><a class="code" href="classmolDynamics_1_1gulp_1_1Gulp_1_1Gulp_1_1Inventory.html#88b3807b2af3cf4cb166fad5879a949e">00045</a>         inputDeckName = inv.str(<span class="stringliteral">'Input Filename'</span>, default = <span class="stringliteral">'molDynamics.in'</span>)
<a name="l00046"></a>00046         inputDeckName.meta[<span class="stringliteral">'tip'</span>] = <span class="stringliteral">'''input file for executable'''</span>
<a name="l00047"></a>00047         integrator = inv.str(<span class="stringliteral">'Integrator'</span>, default = <span class="stringliteral">'velocity-verlet'</span>)
<a name="l00048"></a><a class="code" href="classmolDynamics_1_1gulp_1_1Gulp_1_1Gulp_1_1Inventory.html#b2a38b5d65f67d4ba4c8051a030ee871">00048</a>         integrator.meta[<span class="stringliteral">'tip'</span>] = <span class="stringliteral">'type of integrator'</span>
<a name="l00049"></a>00049         integrator.validator = inv.choice([<span class="stringliteral">'velocity-verlet'</span>, <span class="stringliteral">'leapfrog-verlet'</span>])
<a name="l00050"></a><a class="code" href="classmolDynamics_1_1gulp_1_1Gulp_1_1Gulp_1_1Inventory.html#e9c8a9b88dc6272d951b729e13c28899">00050</a>         optimizeCell = inv.bool(<span class="stringliteral">'Optimize Cell'</span>, default = <span class="keyword">False</span>)
<a name="l00051"></a>00051         optimizeCell.meta[<span class="stringliteral">'tip'</span>] = <span class="stringliteral">'whether to optimize the unit cell'</span>
<a name="l00052"></a><a class="code" href="classmolDynamics_1_1gulp_1_1Gulp_1_1Gulp_1_1Inventory.html#69d8cbacd339c5d8a7ce4f865675d040">00052</a>         optimizeCoordinates = inv.bool(<span class="stringliteral">'Optimize Coordinates'</span>, default = <span class="keyword">False</span>)
<a name="l00053"></a>00053         optimizeCoordinates.meta[<span class="stringliteral">'tip'</span>] = <span class="stringliteral">'whether to optimize the coordinate positions'</span>
<a name="l00054"></a>00054         runType = inv.str(<span class="stringliteral">'Run Type'</span>, default = <span class="stringliteral">'md'</span>)
<a name="l00055"></a>00055         runType.validator=inv.choice([<span class="stringliteral">'md'</span>, <span class="stringliteral">'restart md'</span>, <span class="stringliteral">'optimize'</span>, <span class="stringliteral">'fit'</span>])
<a name="l00056"></a><a class="code" href="classmolDynamics_1_1gulp_1_1Gulp_1_1Gulp_1_1Inventory.html#a4d06a0a2993bb4595f465c98b1daf6f">00056</a>         runType.meta[<span class="stringliteral">'tip'</span>] = <span class="stringliteral">'type of run'</span>
<a name="l00057"></a>00057         runType.meta[<span class="stringliteral">'importance'</span>] = 9
<a name="l00058"></a>00058         trajectoryType = inv.str(<span class="stringliteral">'Trajectory Type'</span>, default = <span class="stringliteral">'xyz'</span>)
<a name="l00059"></a>00059         trajectoryType.meta[<span class="stringliteral">'tip'</span>] = <span class="stringliteral">'''type of trajectory file'''</span>
<a name="l00060"></a>00060         trajectoryType.validator = inv.choice([<span class="stringliteral">'xyz'</span>,
<a name="l00061"></a><a class="code" href="classmolDynamics_1_1gulp_1_1Gulp_1_1Gulp.html#a4aa66e2d884aa6ced469ff62dc4bf88">00061</a>             <span class="stringliteral">'trajectory'</span>,<span class="stringliteral">'history'</span>,<span class="stringliteral">'phonon'</span>,<span class="stringliteral">'arc'</span>])
<a name="l00062"></a>00062   
<a name="l00063"></a><a class="code" href="classmolDynamics_1_1gulp_1_1Gulp_1_1Gulp.html#95b09ddc598e9ab21ecc0d9cf2a85a45">00063</a>     <span class="keyword">def </span><a class="code" href="classmolDynamics_1_1gulp_1_1Gulp_1_1Gulp.html#a4aa66e2d884aa6ced469ff62dc4bf88">__init__</a>(self,name='gulp'):
<a name="l00064"></a>00064         MolDynamics.__init__(self, name, <span class="stringliteral">'mdEngine'</span>)
<a name="l00065"></a>00065         self.<a class="code" href="classmolDynamics_1_1gulp_1_1Gulp_1_1Gulp.html#95b09ddc598e9ab21ecc0d9cf2a85a45">keywords</a>keywords=[]
<a name="l00066"></a>00066     
<a name="l00067"></a>00067     <span class="keyword">def </span>_configure(self):
<a name="l00068"></a>00068         MolDynamics._configure(self)
<a name="l00069"></a>00069     
<a name="l00070"></a>00070     <span class="keyword">def </span>printWarnings(self):
<a name="l00071"></a>00071         <span class="stringliteral">'''print warnings if the user chooses settings which are incorrect'''</span>
<a name="l00072"></a>00072         <span class="keywordflow">pass</span>
<a name="l00073"></a>00073     
<a name="l00074"></a>00074     <span class="keyword">def </span>listToString(self,list):
<a name="l00075"></a>00075         <span class="stringliteral">'''give the keyword string representation of the keyword list'''</span>
<a name="l00076"></a>00076         st=<span class="stringliteral">''</span>
<a name="l00077"></a>00077         <span class="keywordflow">for</span> i <span class="keywordflow">in</span> list:
<a name="l00078"></a>00078             st+=i+<span class="stringliteral">' '</span>
<a name="l00079"></a>00079         <span class="keywordflow">return</span> st
<a name="l00080"></a>00080     
<a name="l00081"></a>00081     <span class="keyword">def </span>getIfDefinedSpace(self, inventoryItem):
<a name="l00082"></a>00082         <span class="keywordflow">if</span> inventoryItem==<span class="keywordtype">None</span>:
<a name="l00083"></a>00083             <span class="keywordflow">return</span> <span class="stringliteral">''</span>
<a name="l00084"></a>00084         <span class="keywordflow">else</span>:
<a name="l00085"></a>00085             <span class="keywordflow">return</span> inventoryItem+<span class="stringliteral">' '</span>
<a name="l00086"></a>00086         
<a name="l00087"></a>00087     <span class="keyword">def </span>writeGeneralKeywords(self):
<a name="l00088"></a>00088         <span class="stringliteral">'''write the general keywords for gulp'''</span>
<a name="l00089"></a>00089         <span class="comment"># these next lines insert 'molecule' in the keyword list if any potentials</span>
<a name="l00090"></a>00090         <span class="comment"># are signaled as intramolecular</span>
<a name="l00091"></a>00091 <span class="comment">#        for ff in self.i.sample.i.forcefields:</span>
<a name="l00092"></a>00092 <span class="comment">#            if ff.i.interIntra!=None and 'molecule' not in self.keywords: </span>
<a name="l00093"></a>00093 <span class="comment">#                self.keywords+=['molecule']</span>
<a name="l00094"></a>00094         <span class="keywordflow">if</span> self.i.identifyMolecules:
<a name="l00095"></a>00095             self.keywords+=[<span class="stringliteral">'molecule'</span>]
<a name="l00096"></a>00096         <span class="keywordflow">if</span> self.i.dispersionInRecipSpace:
<a name="l00097"></a>00097             self.keywords+=[<span class="stringliteral">'c6'</span>]
<a name="l00098"></a>00098         <span class="keywordflow">if</span> self.i.computeMaterialProperties:
<a name="l00099"></a>00099             self.keywords+=[<span class="stringliteral">'property'</span>]
<a name="l00100"></a>00100 
<a name="l00101"></a>00101     <span class="keyword">def </span>writeMDKeywords(self):
<a name="l00102"></a>00102         <span class="stringliteral">'''writes the md keywords'''</span>
<a name="l00103"></a>00103         self.writeGeneralKeywords()
<a name="l00104"></a>00104         <span class="keywordflow">if</span> self.i.ensemble==<span class="stringliteral">'nve'</span> <span class="keywordflow">or</span> self.i.ensemble==<span class="stringliteral">'nvt'</span>:
<a name="l00105"></a>00105             self.keywords=[<span class="stringliteral">'md'</span>,<span class="stringliteral">'conv'</span>]+self.keywords
<a name="l00106"></a>00106         <span class="keywordflow">elif</span> self.i.ensemble==<span class="stringliteral">'npt'</span>: 
<a name="l00107"></a>00107             self.keywords=[<span class="stringliteral">'md'</span>,<span class="stringliteral">'conp'</span>]+self.keywords
<a name="l00108"></a>00108         <span class="keywordflow">return</span> self.listToString(self.keywords)+linesep
<a name="l00109"></a>00109     
<a name="l00110"></a>00110     <span class="keyword">def </span>writeOptimizeKeywords(self):
<a name="l00111"></a>00111         <span class="stringliteral">'''writes the optimize keywords'''</span>
<a name="l00112"></a>00112         self.writeGeneralKeywords()
<a name="l00113"></a>00113         <span class="keywordflow">if</span> self.i.constantVolumeOptimize:
<a name="l00114"></a>00114             self.keywords=[<span class="stringliteral">'optimise'</span>,<span class="stringliteral">'conv'</span>]+self.keywords
<a name="l00115"></a>00115         <span class="keywordflow">elif</span> self.i.constantPressureOptimize: 
<a name="l00116"></a>00116             self.keywords=[<span class="stringliteral">'optimise'</span>,<span class="stringliteral">'conp'</span>]+self.keywords
<a name="l00117"></a>00117         <span class="keywordflow">return</span> self.listToString(self.keywords)+linesep
<a name="l00118"></a>00118     
<a name="l00119"></a>00119     <span class="keyword">def </span>writeFitKeywords(self):
<a name="l00120"></a>00120         <span class="stringliteral">'''writes the fit keywords'''</span>
<a name="l00121"></a>00121         self.writeGeneralKeywords()
<a name="l00122"></a>00122         <span class="keywordflow">if</span> self.i.constantVolumeFit:
<a name="l00123"></a>00123             self.keywords=[<span class="stringliteral">'fit'</span>,<span class="stringliteral">'conv'</span>]+self.keywords
<a name="l00124"></a>00124         <span class="keywordflow">elif</span> self.i.constantPressureFit: 
<a name="l00125"></a>00125             self.keywords=[<span class="stringliteral">'fit'</span>,<span class="stringliteral">'conp'</span>]+self.keywords
<a name="l00126"></a>00126         <span class="keywordflow">return</span> self.listToString(self.keywords)+linesep
<a name="l00127"></a>00127                
<a name="l00128"></a>00128     <span class="keyword">def </span>writeExternalConditions(self):
<a name="l00129"></a>00129         <span class="stringliteral">'''writes external tp conditions'''</span>
<a name="l00130"></a>00130         conditions=<span class="stringliteral">''</span>
<a name="l00131"></a>00131         <span class="keywordflow">if</span> self.i.ensemble==<span class="stringliteral">'nve'</span>:
<a name="l00132"></a>00132             conditions+=<span class="stringliteral">'temperature '</span>+str(self.i.sample.initialTemp)+linesep
<a name="l00133"></a>00133         <span class="keywordflow">elif</span> self.i.ensemble==<span class="stringliteral">'nvt'</span>: 
<a name="l00134"></a>00134             conditions+=<span class="stringliteral">'temperature '</span>+str(self.i.sample.temperature)+linesep
<a name="l00135"></a>00135         <span class="keywordflow">elif</span> self.i.ensemble==<span class="stringliteral">'npt'</span>: 
<a name="l00136"></a>00136             conditions+=<span class="stringliteral">'temperature '</span>+str(self.i.sample.temperature)+linesep
<a name="l00137"></a>00137             conditions+=<span class="stringliteral">'pressure '</span>+str(self.i.sample.pressure)+linesep
<a name="l00138"></a>00138         <span class="keywordflow">return</span> conditions
<a name="l00139"></a>00139     
<a name="l00140"></a>00140     <span class="keyword">def </span>writeUnitCell(self):
<a name="l00141"></a>00141         <span class="stringliteral">'''writes the unit cell in vector format'''</span>
<a name="l00142"></a>00142         lines=<span class="stringliteral">'vectors'</span>+linesep
<a name="l00143"></a>00143         uc=eval(self.i.sample.i.unitCell)
<a name="l00144"></a>00144         lines+=str(uc[0][0])+<span class="stringliteral">' '</span>+str(uc[0][1])+<span class="stringliteral">' '</span>+str(uc[0][2])+linesep
<a name="l00145"></a>00145         lines+=str(uc[1][0])+<span class="stringliteral">' '</span>+str(uc[1][1])+<span class="stringliteral">' '</span>+str(uc[1][2])+linesep
<a name="l00146"></a>00146         lines+=str(uc[2][0])+<span class="stringliteral">' '</span>+str(uc[2][1])+<span class="stringliteral">' '</span>+str(uc[2][2])+linesep
<a name="l00147"></a>00147         <span class="keywordflow">if</span> self.i.optimizeCell:
<a name="l00148"></a>00148             <span class="comment">#remove the last linesep and add the optimize flags</span>
<a name="l00149"></a>00149             lines=lines[:-1]+<span class="stringliteral">' 1 1 1 1 1 1'</span>+linesep
<a name="l00150"></a>00150         <span class="keywordflow">return</span> lines
<a name="l00151"></a>00151     
<a name="l00152"></a>00152     <span class="keyword">def </span>writeEnsemble(self):
<a name="l00153"></a>00153         <span class="stringliteral">'''write the thermodynamic ensemble'''</span>
<a name="l00154"></a>00154         <span class="keywordflow">if</span> self.i.ensemble==<span class="stringliteral">'nve'</span>:
<a name="l00155"></a>00155             <span class="keywordflow">return</span> <span class="stringliteral">'ensemble '</span>+self.i.ensemble+linesep
<a name="l00156"></a>00156         <span class="keywordflow">elif</span> self.i.ensemble==<span class="stringliteral">'nvt'</span>:
<a name="l00157"></a>00157             <span class="keywordflow">return</span> <span class="stringliteral">'ensemble '</span>+self.i.ensemble+<span class="stringliteral">' '</span>+self.i.thermostatParameter+linesep
<a name="l00158"></a>00158         <span class="keywordflow">elif</span> self.i.ensemble==<span class="stringliteral">'npt'</span>:
<a name="l00159"></a>00159             <span class="keywordflow">return</span> <span class="stringliteral">'ensemble '</span>+self.i.ensemble+<span class="stringliteral">' '</span>+self.i.thermostatParameter\
<a name="l00160"></a>00160                 +<span class="stringliteral">' '</span>+self.i.barostatParameter+linesep
<a name="l00161"></a>00161         
<a name="l00162"></a>00162     <span class="keyword">def </span>writePotentials(self):
<a name="l00163"></a>00163         <span class="stringliteral">"""writes out GULP's many potentials."""</span>
<a name="l00164"></a>00164         <span class="keywordflow">return</span> self.i.sample.i.forcefields.writeGulp()
<a name="l00165"></a>00165     
<a name="l00166"></a>00166     <span class="keyword">def </span>writeOutputOptions(self):
<a name="l00167"></a>00167         <span class="stringliteral">'''writes Gulp's output options'''</span>
<a name="l00168"></a>00168         outputDictionary={<span class="stringliteral">'xyz (Gulp)'</span>:<span class="stringliteral">'xyz'</span>,<span class="stringliteral">'netcdf (Mmtk)'</span>:<span class="stringliteral">'nc'</span>,<span class="stringliteral">'trajectory (Gulp)'</span>:<span class="stringliteral">'trajectory'</span>,
<a name="l00169"></a>00169             <span class="stringliteral">'history (Gulp)'</span>:<span class="stringliteral">'history'</span>,<span class="stringliteral">'phonon (Gulp)'</span>:<span class="stringliteral">'phonon'</span>,<span class="stringliteral">'arc (Gulp)'</span>:<span class="stringliteral">'arc'</span>}
<a name="l00170"></a>00170         lines=<span class="stringliteral">''</span>
<a name="l00171"></a>00171         lines+=<span class="stringliteral">'output '</span>+outputDictionary[self.i.trajectoryType]+<span class="stringliteral">' '</span>+self.i.trajectoryFilename+linesep
<a name="l00172"></a>00172         lines+=<span class="stringliteral">'dump '</span>+self.i.restartFilename+linesep
<a name="l00173"></a>00173         <span class="keywordflow">return</span> lines
<a name="l00174"></a>00174     
<a name="l00175"></a>00175     <span class="keyword">def </span>writeMDInfo(self):
<a name="l00176"></a>00176         <span class="stringliteral">'''write molecular dynamics information'''</span>
<a name="l00177"></a>00177         lines=self.writeEnsemble()+\
<a name="l00178"></a>00178         self.writeExternalConditions()+\
<a name="l00179"></a>00179         <span class="stringliteral">'equilibration '</span>+str(self.i.equilibrationTime)+<span class="stringliteral">' ps'</span>+linesep+\
<a name="l00180"></a>00180         <span class="stringliteral">'production '</span>+str(self.i.productionTime)+<span class="stringliteral">' ps'</span>+linesep+\
<a name="l00181"></a>00181         <span class="stringliteral">'timestep '</span>+str(self.i.timeStep)+<span class="stringliteral">' ps'</span>+linesep+\
<a name="l00182"></a>00182         <span class="stringliteral">'sample '</span>+str(self.i.sampleFrequency)+<span class="stringliteral">' ps'</span>+linesep+\
<a name="l00183"></a>00183         <span class="stringliteral">'write '</span>+str(self.i.dumpFrequency)+<span class="stringliteral">' ps'</span>+linesep
<a name="l00184"></a>00184         <span class="keywordflow">return</span> lines
<a name="l00185"></a>00185 
<a name="l00186"></a>00186     <span class="keyword">def </span>writeCommonOptions(self):
<a name="l00187"></a>00187         <span class="stringliteral">'''write common info for all types of runs'''</span>
<a name="l00188"></a>00188         <span class="comment"># coordinate writing is difficult in gulp so use object</span>
<a name="l00189"></a>00189         coords=Coordinates(self.i)
<a name="l00190"></a>00190         commonOptions = self.writeUnitCell()
<a name="l00191"></a>00191         commonOptions+= coords.write()
<a name="l00192"></a>00192         commonOptions+=self.writePotentials()+\
<a name="l00193"></a>00193         self.writeOutputOptions()
<a name="l00194"></a>00194         <span class="keywordflow">return</span> commonOptions
<a name="l00195"></a>00195 
<a name="l00196"></a><a class="code" href="classmolDynamics_1_1gulp_1_1Gulp_1_1Gulp.html#23dae497509fac4a3443b030983f2b38">00196</a>     <span class="keyword">def </span>integrate(self):
<a name="l00197"></a>00197         <span class="stringliteral">'''integrates an MD trajectory forward in time'''</span>
<a name="l00198"></a>00198         self.<a class="code" href="classmolDynamics_1_1gulp_1_1Gulp_1_1Gulp.html#23dae497509fac4a3443b030983f2b38">inputFileContents</a>inputFileContents = self.writeMDKeywords()+\
<a name="l00199"></a>00199         self.writeCommonOptions()+\
<a name="l00200"></a>00200         self.writeMDInfo()
<a name="l00201"></a>00201         f=file(self.i.inputDeck,<span class="stringliteral">'w'</span>)
<a name="l00202"></a>00202         f.write(self.<a class="code" href="classmolDynamics_1_1gulp_1_1Gulp_1_1Gulp.html#23dae497509fac4a3443b030983f2b38">inputFileContents</a>inputFileContents)
<a name="l00203"></a>00203         f.close()
<a name="l00204"></a>00204         system(self.i.engineExecutablePath+<span class="stringliteral">' &lt; '</span>+self.i.inputDeck+<span class="stringliteral">' &gt; '</span>+self.i.logFilename)
<a name="l00205"></a>00205         
<a name="l00206"></a>00206     <span class="keyword">def </span>optimize(self):
<a name="l00207"></a>00207         <span class="stringliteral">'''optimize a unit cell'''</span>
<a name="l00208"></a>00208         <span class="comment"># add the keywords last</span>
<a name="l00209"></a>00209         self.<a class="code" href="classmolDynamics_1_1gulp_1_1Gulp_1_1Gulp.html#23dae497509fac4a3443b030983f2b38">inputFileContents</a>inputFileContents=self.writeOptimizeKeywords()+self.writeCommonOptions()
<a name="l00210"></a>00210         f=file(self.i.inputDeck,<span class="stringliteral">'w'</span>)
<a name="l00211"></a>00211         f.write(self.<a class="code" href="classmolDynamics_1_1gulp_1_1Gulp_1_1Gulp.html#23dae497509fac4a3443b030983f2b38">inputFileContents</a>inputFileContents)
<a name="l00212"></a>00212         f.close()
<a name="l00213"></a>00213         system(self.i.engineExecutablePath+<span class="stringliteral">' &lt; '</span>+self.i.inputDeck+<span class="stringliteral">' &gt; '</span>+self.i.logFilename)
<a name="l00214"></a>00214         
<a name="l00215"></a>00215     <span class="keyword">def </span>restartIntegrate(self):
<a name="l00216"></a>00216         <span class="stringliteral">'''restart a previous md integration'''</span>
<a name="l00217"></a>00217         system(self.i.engineExecutablePath+<span class="stringliteral">' &lt; '</span>+self.i.restartFilename+<span class="stringliteral">' &gt;&gt; '</span>+self.i.logFilename)
<a name="l00218"></a>00218 
<a name="l00219"></a>00219     <span class="keyword">def </span>fit(self):
<a name="l00220"></a>00220         <span class="stringliteral">'''fit potentials to experimental data or ab initio calculations'''</span>
<a name="l00221"></a>00221         <span class="comment">#add the keywords last</span>
<a name="l00222"></a>00222         self.<a class="code" href="classmolDynamics_1_1gulp_1_1Gulp_1_1Gulp.html#23dae497509fac4a3443b030983f2b38">inputFileContents</a>inputFileContents=self.writeFitKeywords()+self.writeCommonOptions()
<a name="l00223"></a>00223         f=file(self.i.inputDeck,<span class="stringliteral">'w'</span>)
<a name="l00224"></a>00224         f.write(self.<a class="code" href="classmolDynamics_1_1gulp_1_1Gulp_1_1Gulp.html#23dae497509fac4a3443b030983f2b38">inputFileContents</a>inputFileContents)
<a name="l00225"></a>00225         f.close()
<a name="l00226"></a>00226         system(self.i.engineExecutablePath+<span class="stringliteral">' &lt; '</span>+self.i.inputDeck+<span class="stringliteral">' &gt; '</span>+self.i.logFilename)
<a name="l00227"></a>00227         
<a name="l00228"></a>00228     <span class="keyword">def </span>execute(self):
<a name="l00229"></a>00229         <span class="stringliteral">'''writes out the files and starts the executable'''</span>
<a name="l00230"></a>00230         self.printWarnings()
<a name="l00231"></a>00231         <span class="keywordflow">if</span> self.i.runType==<span class="stringliteral">'md'</span>:
<a name="l00232"></a>00232             self.integrate()
<a name="l00233"></a>00233         <span class="keywordflow">elif</span> self.i.runType==<span class="stringliteral">'mdRestart'</span>:
<a name="l00234"></a>00234             self.restart()
<a name="l00235"></a>00235         <span class="keywordflow">elif</span> self.i.runType==<span class="stringliteral">'optimize'</span>:
<a name="l00236"></a>00236             self.optimize()
<a name="l00237"></a>00237         <span class="keywordflow">else</span>: <span class="comment">#fit</span>
<a name="l00238"></a>00238             self.fit()
<a name="l00239"></a>00239   
<a name="l00240"></a>00240 <span class="comment"># version</span>
<a name="l00241"></a>00241 __id__ = <span class="stringliteral">"$Id$"</span>
<a name="l00242"></a>00242  
<a name="l00243"></a>00243 <span class="comment"># End of file</span>
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Fri Sep 28 18:26:00 2007 for molDynamics by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.1 </small></address>
</body>
</html>
